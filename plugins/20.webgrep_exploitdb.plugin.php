<?php
/*
	Commands:
            .exploitdb <search>
*/
class webgrep_exploitdb_plugin extends webgrep{
    protected $web = array('command' => '.exploitdb',
			   'url' => 'http://www.exploit-db.com/search/?action=search&filter_page=1&filter_exploit_text=&filter_author=&filter_platform=0&filter_type=0&filter_lang_id=0&filter_port=&filter_osvdb=&filter_cve=&filter_description=',
			   'regex' => '@<a  href="(http://www.exploit-db.com/exploits/\d+)">(.+?)</a>@',    
			   'maxMatchs' => 10,
			   'stripTags' => true,
			   'stripNewLines' => true,
			   'htmlDecode' => true,
			   'stripMultipleBlanks' => true);
	
	public function pluginHelp(){
		return array('exploitdb', ' <term>: searchs <term> in exploit-db.com and returns up to 10 results.', true);
	}
}
